{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    "security:openssf-scorecard"
  ],
  "bumpVersion": "patch",
  "prHourlyLimit": 12,
  "customManagers": [
    {
      "description": "Sync Dashy appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/apps/dashy/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "lissy93/dashy",
      "extractVersionTemplate": "^(?<version>.*)$"
    },
    {
      "description": "Sync Jellyfin appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/apps/jellyfin/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "jellyfin/jellyfin",
      "extractVersionTemplate": "^(?<version>.*)$"
    },
    {
      "description": "Sync Spoolman appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/apps/spoolman/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "Donkie/Spoolman",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "description": "Sync Kyverno appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/kyverno/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "kyverno/kyverno",
      "extractVersionTemplate": "^(?<version>.*)$",
      "versioningTemplate": "loose"
    },
    {
      "description": "Sync CloudNativePG appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/cnpg-system/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "cloudnative-pg/cloudnative-pg",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "description": "Sync intel-device-plugins appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/intel-device-plugins-gpu/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "intel/intel-device-plugins-for-kubernetes",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "description": "Sync kured appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/kured/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "kubereboot/kured",
      "extractVersionTemplate": "^(?<version>.*)$"
    },
    {
      "description": "Sync longhorn appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/longhorn-system/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "longhorn/longhorn",
      "extractVersionTemplate": "^longhorn-(?<version>.*)$"
    },
    {
      "description": "Sync node-feature-discovery appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/node-feature-discovery/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "kubernetes-sigs/node-feature-discovery",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "description": "Sync secret-system appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/foundation/secret-system/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "mittwald/kubernetes-secret-generator",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "description": "Sync Gitea appVersion with GitHub releases",
      "customType": "regex",
      "managerFilePatterns": [
        "k8s/platform/gitea/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"?(?<currentValue>[^\"\\s]+)\"?"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "go-gitea/gitea",
      "extractVersionTemplate": "^v(?<version>.*)$"
    }
  ],
  "nix": {
    "enabled": true
  },
  "packageRules": [
    {
      "groupName": "all non-major dependencies (excluding 0.x)",
      "groupSlug": "all-minor-patch-semver",
      "matchPackageNames": [
        "*"
      ],
      "matchManagers": [
        "gomod",
        "helm-values",
        "helmfile",
        "helmv3",
        "jsonnet-bundler",
        "nix",
        "terraform"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "matchCurrentValue": "!/^v?0\\./"
    },
    {
      "groupName": "helm dashy",
      "matchFileNames": [
        "k8s/apps/dashy/**"
      ],
      "matchPackageNames": [
        "dashy",
        "lissy93/dashy"
      ]
    },
    {
      "groupName": "helm jellyfin",
      "matchFileNames": [
        "k8s/apps/jellyfin/**"
      ],
      "matchPackageNames": [
        "alpine",
        "app-template",
        "ghcr.io/jellyfin/jellyfin",
        "docker.io/fallenbagel/jellyseerr",
        "lscr.io/linuxserver/prowlarr",
        "lscr.io/linuxserver/radarr",
        "lscr.io/linuxserver/sonarr",
        "ghcr.io/unpackerr/unpackerr",
        "lscr.io/linuxserver/qbittorrent",
        "docker.io/qmcgaw/gluetun",
        "jellyfin/jellyfin"
      ]
    },
    {
      "groupName": "helm spoolman",
      "matchFileNames": [
        "k8s/apps/spoolman/**"
      ],
      "matchPackageNames": [
        "app-template",
        "ghcr.io/donkie/spoolman",
        "Donkie/Spoolman"
      ]
    },
    {
      "groupName": "helm argocd",
      "matchFileNames": [
        "k8s/foundation/argocd/**"
      ],
      "matchPackageNames": [
        "argo-cd",
        "argocd-apps"
      ]
    },
    {
      "groupName": "helm cert-system",
      "matchFileNames": [
        "k8s/foundation/cert-system/**"
      ],
      "matchPackageNames": [
        "cert-manager",
        "trust-manager",
        "step-certificates",
        "step-issuer",
        "cr.step.sm/smallstep/step-ca",
        "cr.step.sm/smallstep/step-issuer"
      ]
    },
    {
      "groupName": "helm cnpg-system",
      "matchFileNames": [
        "k8s/foundation/cnpg-system/**"
      ],
      "matchPackageNames": [
        "cloudnative-pg",
        "cloudnative-pg/cloudnative-pg"
      ]
    },
    {
      "groupName": "helm external-dns",
      "matchFileNames": [
        "k8s/foundation/external-dns/**"
      ],
      "matchPackageNames": [
        "external-dns"
      ]
    },
    {
      "groupName": "helm generic-cdi-plugin",
      "matchFileNames": [
        "k8s/foundation/generic-cdi-plugin/**"
      ],
      "matchPackageNames": [
        "ghcr.io/olfillasodikno/generic-cdi-plugin"
      ]
    },
    {
      "groupName": "helm intel-device-plugins-gpu",
      "matchFileNames": [
        "k8s/foundation/intel-device-plugins-gpu/**"
      ],
      "matchPackageNames": [
        "intel-device-plugins-operator",
        "intel-device-plugins-gpu",
        "intel/intel-device-plugins-for-kubernetes"
      ]
    },
    {
      "groupName": "helm kyverno",
      "matchFileNames": [
        "k8s/foundation/kyverno/**"
      ],
      "matchPackageNames": [
        "kyverno",
        "kyverno/kyverno"
      ]
    },
    {
      "groupName": "helm kured",
      "matchFileNames": [
        "k8s/foundation/kured/**"
      ],
      "matchPackageNames": [
        "kured",
        "kubereboot/kured"
      ]
    },
    {
      "groupName": "helm longhorn-system",
      "matchFileNames": [
        "k8s/foundation/longhorn-system/**"
      ],
      "matchPackageNames": [
        "longhorn",
        "longhorn/charts"
      ]
    },
    {
      "groupName": "helm node-feature-discovery",
      "matchFileNames": [
        "k8s/foundation/node-feature-discovery/**"
      ],
      "matchPackageNames": [
        "node-feature-discovery",
        "kubernetes-sigs/node-feature-discovery"
      ]
    },
    {
      "groupName": "helm secret-system",
      "matchFileNames": [
        "k8s/foundation/secret-system/**"
      ],
      "matchPackageNames": [
        "kubernetes-secret-generator",
        "mittwald/kubernetes-secret-generator"
      ]
    },
    {
      "groupName": "helm auth-system",
      "matchFileNames": [
        "k8s/platform/auth-system/**"
      ],
      "matchPackageNames": [
        "authelia",
        "app-template",
        "ghcr.io/lldap/lldap"
      ]
    },
    {
      "groupName": "helm csi-driver-smb",
      "matchFileNames": [
        "k8s/platform/csi-driver-smb/**"
      ],
      "matchPackageNames": [
        "csi-driver-smb"
      ]
    },
    {
      "groupName": "helm gitea",
      "matchFileNames": [
        "k8s/platform/gitea/**"
      ],
      "matchPackageNames": [
        "gitea",
        "ghcr.io/cloudnative-pg/postgresql",
        "go-gitea/gitea"
      ]
    },
    {
      "groupName": "helm monitoring-system",
      "matchFileNames": [
        "k8s/platform/monitoring-system/**"
      ],
      "matchPackageNames": [
        "kube-prometheus-stack",
        "teekennedy/prometheus-operator",
        "ghcr.io/teekennedy/prometheus-operator"
      ]
    },
    {
      "groupName": "helm renovate",
      "matchFileNames": [
        "k8s/platform/renovate/**"
      ],
      "matchPackageNames": [
        "renovate"
      ]
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "alpine"
      ],
      "allowedVersions": "/^latest$/",
      "pinDigests": true
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "lissy93/dashy"
      ],
      "versioning": "regex:^release-(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)$"
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "ghcr.io/teekennedy/prometheus-operator"
      ],
      "allowedVersions": "/^discord-webhook-file-fix$/",
      "pinDigests": true
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "ghcr.io/lldap/lldap"
      ],
      "versioning": "regex:^(?<minor>\\d+)-(?<patch>\\d+)-(?<build>\\d+)-(?<compatibility>.*)?$"
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "versioning": "regex:^(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)(?:[.-]r?(?<build>\\d+))?-ls(?<revision>\\d+)$",
      "matchPackageNames": [
        "/^(?:gh|ls)cr\\.io/linuxserver//"
      ]
    },
    {
      "matchPackageNames": [
        "ghcr.io/jellyfin/jellyfin"
      ],
      "sourceUrl": "https://github.com/jellyfin/jellyfin"
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "sourceUrl": "https://github.com/Prowlarr/Prowlarr",
      "matchPackageNames": [
        "/^(?:gh|ls)cr\\.io/linuxserver/prowlarr$/"
      ]
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "sourceUrl": "https://github.com/Sonarr/Sonarr",
      "matchPackageNames": [
        "/^(?:gh|ls)cr\\.io/linuxserver/sonarr$/"
      ]
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "sourceUrl": "https://github.com/Radarr/Radarr",
      "matchPackageNames": [
        "/^(?:gh|ls)cr\\.io/linuxserver/radarr$/"
      ]
    },
    {
      "matchDatasources": [
        "docker"
      ],
      "sourceUrl": "https://github.com/qbittorrent/qBittorrent",
      "matchPackageNames": [
        "/^(?:gh|ls)cr\\.io/linuxserver/qbittorrent$/"
      ]
    }
  ]
}
