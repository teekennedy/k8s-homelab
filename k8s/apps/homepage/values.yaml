homepage:
  image:
    registry: ghcr.io
    repository: gethomepage/homepage
    tag: "v1.9.0"
  ingress:
    enabled: true
    ingressClassName: anubis
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      traefik.ingress.kubernetes.io/router.entrypoints: websecurepublic
      traefik.ingress.kubernetes.io/router.middlewares: homepage-public-rate-limit@kubernetescrd
      external-dns.alpha.kubernetes.io/target: external.network.msng.to
      external-dns.alpha.kubernetes.io/record-type: CNAME
    hosts:
      - host: &homepageHost msng.to
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: homepage-tls-certificate
        hosts:
          - *homepageHost
  volumeMounts:
    - name: homepage-config
      mountPath: /app/config/settings.yaml
      subPath: settings.yaml
    - name: homepage-config
      mountPath: /app/config/kubernetes.yaml
      subPath: kubernetes.yaml
    - name: homepage-config
      mountPath: /app/config/services.yaml
      subPath: services.yaml
    - name: homepage-config
      mountPath: /app/config/bookmarks.yaml
      subPath: bookmarks.yaml
    - name: homepage-config
      mountPath: /app/config/widgets.yaml
      subPath: widgets.yaml
    - name: nas
      mountPath: /mnt/nas
      readOnly: true
  volumes:
    - name: homepage-config
      configMap:
        name: homepage-config
    - name: nas
      persistentVolumeClaim:
        claimName: homepage-nas
  extraEnv:
    - name: LOG_TARGETS
      value: stdout
  extraEnvFrom:
    - secretRef:
        name: homepage-secrets

secret-sync:
  enabled: true
  cron:
    enabled: false
  schedule: "*/30 * * * *"
  image:
    repository: golang
    tag: 1.25.5-alpine
  events:
    enabled: true
    eventBusName: homepage-secret-sync
    eventSourceName: homepage-secret-sync
    sensorName: homepage-secret-sync
    eventSourceServiceAccount: homepage-secret-sync-eventsource
    sensorServiceAccount: homepage-secret-sync-sensor
  rollout:
    enabled: true
    namespace: homepage
    deployment: homepage
    annotation: homepage-secret-sync/restarted-at
  output-secret:
    name: homepage-secrets
    namespace: homepage
    type: Opaque
  mappings:
    - env: HOMEPAGE_VAR_JELLYSEERR_API_KEY
      source:
        namespace: jellyfin
        name: api-keys
        key: SEERR_API_KEY
    - env: HOMEPAGE_VAR_SONARR_API_KEY
      source:
        namespace: jellyfin
        name: api-keys
        key: SONARR_API_KEY
    - env: HOMEPAGE_VAR_RADARR_API_KEY
      source:
        namespace: jellyfin
        name: api-keys
        key: RADARR_API_KEY
    - env: HOMEPAGE_VAR_PROWLARR_API_KEY
      source:
        namespace: jellyfin
        name: api-keys
        key: PROWLARR_API_KEY
    - env: HOMEPAGE_VAR_GRAFANA_USERNAME
      source:
        namespace: monitoring-system
        name: homepage-grafana-credentials
        key: username
    - env: HOMEPAGE_VAR_GRAFANA_PASSWORD
      source:
        namespace: monitoring-system
        name: homepage-grafana-credentials
        key: password
    - env: HOMEPAGE_VAR_GITEA_API_KEY
      source:
        namespace: gitea
        name: homepage-gitea-credentials
        key: token
    - env: HOMEPAGE_VAR_JELLYFIN_API_KEY
      source:
        namespace: jellyfin
        name: jellyfin-homepage-api-key
        key: api-key
      optional: true
    - env: HOMEPAGE_VAR_QBITTORRENT_USERNAME
      source:
        namespace: jellyfin
        name: qbittorrent-credentials
        key: username
      optional: true
    - env: HOMEPAGE_VAR_QBITTORRENT_PASSWORD
      source:
        namespace: jellyfin
        name: qbittorrent-credentials
        key: password
      optional: true
    - env: HOMEPAGE_VAR_ARGOCD_API_KEY
      source:
        namespace: argocd
        name: homepage-argocd-token
        key: token
      optional: true
